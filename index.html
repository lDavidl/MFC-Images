<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Dragon Emperor Images</title>
<style>
  body { font-family: sans-serif; background: #f9f9f9; padding: 20px; margin: 0; }
  h1 { text-align: center; margin-bottom: 40px; }
  
  .gallery { 
    display: grid; 
    grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); 
    gap: 20px; 
    justify-items: center;
  }
  
  .item { text-align: center; cursor: pointer; transition: transform 0.2s; }
  .item:hover { transform: scale(1.05); }

  img { 
    width: 100%; 
    height: auto; 
    max-width: 200px; 
    border: 1px solid #ccc; 
    border-radius: 6px; 
    box-shadow: 0 2px 6px rgba(0,0,0,0.1);
  }
  
  .filename { font-size: 0.9em; color: #333; word-break: break-word; margin-top: 6px; cursor: pointer; }
  .filename:hover { text-decoration: underline; }

  /* Modal styles */
  .modal { display: none; position: fixed; z-index: 1000; padding-top: 60px; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.8); }
  .modal-content { margin: auto; display: block; max-width: 90%; max-height: 80%; }
  .modal-caption { margin: auto; display: block; width: 80%; text-align: center; color: #fff; font-size: 1em; padding: 10px 0; }
  .close { position: absolute; top: 20px; right: 35px; color: #fff; font-size: 40px; font-weight: bold; cursor: pointer; }

  @media (max-width: 400px) { img { max-width: 140px; } }
</style>
</head>
<body>
<h1>...</h1>
<!-- Added class="gallery" here -->
<div id="gallery" class="gallery"></div>

<!-- Modal -->
<div id="modal" class="modal">
  <span class="close">&times;</span>
  <img class="modal-content" id="modal-img">
  <div class="modal-caption" id="modal-caption"></div>
</div>

<script>
const owner = "lDavidl";
const repo = "MFC-Images";
const folder = ""; // root folder
const baseURL = "https://img.dragonemperor.xyz/"; // full URL base for copying

const gallery = document.getElementById("gallery");
const modal = document.getElementById("modal");
const modalImg = document.getElementById("modal-img");
const modalCaption = document.getElementById("modal-caption");
const closeBtn = document.getElementsByClassName("close")[0];

fetch(`https://api.github.com/repos/${owner}/${repo}/contents/${folder}`)
  .then(res => res.json())
  .then(files => {
    const gifs = files.filter(f => f.name.match(/\.gif$/i)).sort((a,b) => a.name.localeCompare(b.name));
    const others = files.filter(f => f.name.match(/\.(jpg|jpeg|png|webp)$/i)).sort((a,b) => a.name.localeCompare(b.name));
    [...gifs, ...others].forEach(file => {
      const div = document.createElement("div");
      div.className = "item";

      const img = document.createElement("img");
      img.src = file.download_url;
      img.alt = file.name;

      const caption = document.createElement("div");
      caption.className = "filename";
      caption.textContent = file.name;
      caption.title = "Click to copy full URL";

      // Click to copy full URL
      caption.onclick = (e) => {
        e.stopPropagation(); // prevent modal opening
        const fullURL = `${baseURL}${file.name}`;
        navigator.clipboard.writeText(fullURL)
          .then(() => {
            caption.textContent = "Copied!";
            setTimeout(() => { caption.textContent = file.name; }, 1000);
          })
          .catch(err => console.error("Failed to copy URL:", err));
      };

      div.appendChild(img);
      div.appendChild(caption);
      gallery.appendChild(div);

      // Click to open modal
      div.onclick = (e) => {
        if(e.target !== caption) { // don't open modal when filename clicked
          modal.style.display = "block";
          modalImg.src = file.download_url;
          modalCaption.textContent = file.name;
        }
      };
    });
  })
  .catch(err => console.error("Error loading images:", err));

// Close modal
closeBtn.onclick = () => { modal.style.display = "none"; };
modal.onclick = (e) => { if(e.target == modal) modal.style.display = "none"; };
</script>
</body>
</html>
